<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QuIt Tab Manager</title>
  <link rel="stylesheet" href="popup.css">
  <link rel="stylesheet" href="modal.css">
</head>

<body>
  <!-- Include SVG Icons -->
  <div style="display: none;">
    <svg xmlns="http://www.w3.org/2000/svg">
      <symbol id="icon-clock" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2" />
        <path d="M12 7v5l3 3" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
      </symbol>
      <symbol id="icon-settings" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="2" />
        <path
          d="M12 1v6m0 6v10m8.66-15l-5.2 3m-2.92 5l-5.2 3M23 12h-6m-6 0H1m19.07-7.07l-4.24 4.24m-5.66 5.66l-4.24 4.24M5.93 5.93l4.24 4.24m5.66 5.66l4.24 4.24"
          stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
      </symbol>
      <symbol id="icon-search" viewBox="0 0 24 24">
        <circle cx="11" cy="11" r="8" fill="none" stroke="currentColor" stroke-width="2" />
        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
      </symbol>
      <symbol id="icon-pause" viewBox="0 0 24 24">
        <rect x="6" y="4" width="4" height="16" rx="1" fill="currentColor" />
        <rect x="14" y="4" width="4" height="16" rx="1" fill="currentColor" />
      </symbol>
      <symbol id="icon-play" viewBox="0 0 24 24">
        <path d="M8 5v14l11-7z" fill="currentColor" />
      </symbol>
      <symbol id="icon-shield" viewBox="0 0 24 24">
        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" fill="none" stroke="currentColor" stroke-width="2"
          stroke-linecap="round" stroke-linejoin="round" />
      </symbol>
      <symbol id="icon-folder" viewBox="0 0 24 24">
        <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      </symbol>
      <symbol id="icon-close" viewBox="0 0 24 24">
        <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
      </symbol>
      <symbol id="icon-globe" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2" />
        <path d="M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10zM2.05 12H22"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      </symbol>
    </svg>
  </div>

  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="logo">
        <svg class="logo-icon" width="18" height="18">
          <use href="#icon-clock" />
        </svg>
        <h1>QuIt</h1>
      </div>
      <div class="header-actions">
        <button id="settingsBtn" class="icon-btn" title="Settings">
          <svg width="18" height="18">
            <use href="#icon-settings" />
          </svg>
        </button>
      </div>
    </header>

    <!-- Current Tab Section -->
    <section class="current-tab">
      <h2>Current Tab</h2>
      <div id="currentTabInfo" class="tab-info">
        <div class="tab-favicon" id="currentFavicon">
          <svg width="16" height="16" style="opacity: 0.3;">
            <use href="#icon-globe" />
          </svg>
        </div>
        <div class="tab-details">
          <div class="tab-title">Loading...</div>
          <div class="tab-url">—</div>
        </div>
        <div id="currentTabCountdown" class="countdown">
          <span class="countdown-time">—</span>
        </div>
      </div>

      <div class="quick-actions">
        <button id="pauseBtn" class="btn btn-secondary" title="Pause">
          <svg width="14" height="14" id="pauseIcon">
            <use href="#icon-pause" />
          </svg>
        </button>
        <button id="addDomainBtn" class="btn btn-secondary">
          <svg width="14" height="14">
            <use href="#icon-shield" />
          </svg>
          Exclude
        </button>
      </div>
    </section>

    <!-- Search Box -->
    <div class="search-box">
      <svg class="search-icon" width="14" height="14">
        <use href="#icon-search" />
      </svg>
      <input type="text" id="searchInput" placeholder="Search tabs...">
      <button id="clearSearch" class="clear-btn" style="display: none;">
        <svg width="10" height="10">
          <use href="#icon-close" />
        </svg>
      </button>
    </div>

    <!-- All Tabs List -->
    <section class="tabs-section">
      <div class="section-header">
        <h2>All Tabs (<span id="tabCount">0</span>)</h2>
        <div class="section-actions">
          <button id="mergeDuplicatesBtn" class="toggle-btn" title="Merge Duplicate Tabs">
            <svg width="12" height="12">
              <use href="#icon-merge" />
            </svg>
            Merge
          </button>
          <button id="groupByWindowBtn" class="toggle-btn">
            <svg width="12" height="12">
              <use href="#icon-folder" />
            </svg>
            Window
          </button>
        </div>
      </div>
      <div id="tabsList" class="tabs-list">
        <div class="loading">Loading tabs...</div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="status">
        <span class="status-indicator" id="statusIndicator"></span>
        <span id="statusText">Active</span>
      </div>
    </footer>
  </div>

  <!-- Exclusion Rule Modal -->
  <div id="exclusionModal" class="modal" style="display: none;">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3>Add Exclusion Rule</h3>
        <button id="closeModal" class="icon-btn">
          <svg width="16" height="16">
            <use href="#icon-close" />
          </svg>
        </button>
      </div>

      <div class="modal-body">
        <!-- Row 1: Preview (Fixed) -->
        <div class="preview-section">
          <div class="preview-title">What will be protected:</div>
          <div class="preview-examples" id="previewExamples">
            <div class="preview-item preview-match">✓ example.com</div>
            <div class="preview-item preview-no-match">✗ sub.example.com</div>
          </div>
        </div>

        <!-- Row 2: Scrollable Options -->
        <div class="scroll-section">
          <div class="form-group">
            <label>What should stay open?</label>
            <div class="rule-type-options">
              <label class="radio-option">
                <input type="radio" name="ruleType" value="path_exact" checked>
                <div class="radio-label">
                  <div class="radio-title">Just this page</div>
                  <div class="radio-desc" id="previewPageOnly">example.com/videos/watch</div>
                </div>
              </label>

              <label class="radio-option">
                <input type="radio" name="ruleType" value="domain_path">
                <div class="radio-label">
                  <div class="radio-title">This whole site</div>
                  <div class="radio-desc" id="previewWholeSite">Any page on example.com</div>
                </div>
              </label>

              <label class="radio-option">
                <input type="radio" name="ruleType" value="domain_all">
                <div class="radio-label">
                  <div class="radio-title">Site + related sites</div>
                  <div class="radio-desc" id="previewSiteAndRelated">example.com + api.example.com</div>
                </div>
              </label>

              <label class="radio-option">
                <input type="radio" name="ruleType" value="regex">
                <div class="radio-label">
                  <div class="radio-title">Custom pattern (advanced)</div>
                  <div class="radio-desc">Use your own regex pattern</div>
                </div>
              </label>
            </div>
          </div>

          <!-- Regex Input Field (only shown when regex is selected) -->
          <div class="form-group" id="regexInputGroup" style="display: none;">
            <label for="regexPattern">Regular Expression</label>
            <input type="text" id="regexPattern" class="regex-input" placeholder="^https://.*\.example\.com/.*$">
            <div class="regex-help">
              <span class="regex-help-text">Example: <code>^https://github\.com/.*/issues$</code></span>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <!-- Query Parameters Checkbox (works with all rule types except regex) -->
        <div class="footer-checkbox" id="queryStringGroup">
          <label class="checkbox-option-inline">
            <input type="checkbox" id="includeQueryString" checked>
            <span class="checkbox-text">Include query parameters</span>
            <span class="checkbox-tooltip">
              <span class="tooltip-icon">ℹ️</span>
              <span class="tooltip-content">
                <strong>Check for:</strong> YouTube videos (?v=abc), specific items<br>
                <strong>Uncheck for:</strong> Search pages (?page=2), pagination
              </span>
            </span>
          </label>
        </div>
        <div class="footer-buttons">
          <button id="cancelExclude" class="btn btn-secondary">Cancel</button>
          <button id="confirmExclude" class="btn btn-primary">Add Rule</button>
        </div>
      </div>
    </div>
  </div>

  <script src="popup.js" type="module"></script>
</body>

</html>